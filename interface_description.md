## **Описание интерфейса**

### **Описание интерфейса обработки**

#### **Параметры обработки**

В момент установки обработки в вашу конфигурацию будут доступны команды:

- Синхронизация из 1С в ClickHouseDB, PostgreSQL, и MySQL ручное
- Фоновая выгрузка (все настройки)
- Фоновая выгрузка №1 ... №10
- Фоновая по умолчанию

**Синхронизация из 1С в ClickHouseDB, PostgreSQL, и MySQL ручное** Запустится основная форма обработки.

**Фоновая выгрузка (все настройки)** Задаются настройки расписания для фонового исполнения всех запросов из таблицы запросов в основной форме.

**Фоновая выгрузка №1 ... №10** Параметры фонового исполнения по расписанию определенного номера запроса из таблицы запросов.

**Фоновая по умолчанию** Используется для запуска примера запроса, который можно переназначить через конфигуратор.

#### **Основная форма обработки**

##### **Вкладка "Настройки" На этой вкладке задаются параметры подключения к базе данных (ClickhouseDB, PostgreSQL, MySQL) или к сервису приема сообщение API REST и шин данных (CSV, JSON, SQL).**

 1. **Имя базы** - имя базы данных.
 2. **Тип -** тип подключения, какая база данных или REST. Подключение к ClickHouseDB осуществляется нативно. Подключение к PostgreSQL и MySQL происходит через Python. Требуется установка на сервер предприятия или на ПК, где запускается обработка версии не менее 3.8. Через консоль Python требуется установить библиотеку подключения к определенной базе данных.
 3. **Формат** - дополнительные опции помимо SQL есть в REST. Опция отвечает за то, в каком виде будут отправляться данные в REST API или шину данных: CSV, CSV с заголовками, JSON или форматы SQL запросов для ClickHouseDB, PostgreSQL или MySQL.
 4. **SSL** - используется ли защищенное соединение или нет.
 5. **Порт** - какой порт подключения к базе данных или REST.
 6. **Путь до сертификата** - сертификат CA который используется для подключения по SSL. Указывается абсолютный путь, куда есть доступ у службы приложений 1С на сервере или на клиенте, если файловый вариант.
 7. **Пароль -** пароль для авторизации.
 8. **Включить параметры запроса REST** - вложить ли в строку подключения ? и & параметры исполнения обработки: индекс запроса, индекс итерации, индекс строки итераций, количество передаваемых строк.
 9. **Абсолютный путь Python** - задается путь, где исполняемый файл Python для запуска скриптов. Можно задать значение python, если задан корректно параметр операционной системы PATH / sbin
10. **Путь к файлу настройки -** абсолютный путь для сохранения конфигурационного файла обработки. Путь задается вместе с расширением.
11. **Сохранить настройки обработки в файл** - Кнопка сохранения настроек обработки в формате JSON.
12. **Загрузить настройки обработки из файла** - Кнопка загрузки настроек из сохраненного файла настроек в формате JSON.

 

##### **Вкладка "Текущий запрос"**

 1. **Имя таблицы** - наименование таблицы на русском или латинице в подключаемой базе данных или REST. Наименование на кириллице будет переведено в латиницу через транслит.
 2. **Проверять?** - опция в разработке
 3. **Период -** период за который требуется выгрузка данных.
 4. **Эта текущая дата -** опция, если включено, то заданный "Период" игнорируется, а рассчитывается с помощью "Количество дней назад": Дата начала = Текущая дата минус "Количество дней назад", Дата окончания = Текущая дата.
 5. **Вызвать конструктор** - кнопка вызова стандартного конструктора запросов на языке 1С.
 6. **Отправить запрос** - кнопка запускается процедуру отправки данных, которые доступны по заданному тексту запроса немедленно.
 7. **Поле** - Текст запроса
 8. **Количество дней назад -** сколько дней вычесть из текущей даты для расчета Даты начала.
 9. **Отключить?** - опция отключает счетчик "по дням" и выполняет запрос с учетом сдвига в датах за один раз, а не по дням. При включенной опции, переопределите Период с помощью "ПериодРегистратор" и подставьте дату из документа.
10. **Количество в портиции** - сколько строк из табличной части отправлять в базу данных или REST
11. **Одним файлом** - опция, если включено, то отправляется файлом состоящим из строк в портиции. Если выключена, то отправляется построчно.
12. **Использовать период в ключе** - опция, если включено, то при создании таблицы в базе данных, добавится поле "Период" и будет использовано в качестве ключа в таблице базы данных. Если выключено, то поле "Период" не будет. В запросе нельзя использовать свое поле "Период", требуется переименовать в "ПериодРегистратор".
13. **Использовать дополнительные ключи** - опция, использовать или нет дополнительные ключи в таблице базы данных. В данный момент используются предустановленные ключи: "База", "НомерГТД", "Серия", "НомерСтроки", "СсылкаGUID", "РасчетныйСчет", "Валюта".
14. **Периодичность** - список опций: "День", "Месяц". Используется при формирования запроса и установке параметров Дата начала и Дата окончания. Если установлен "День", то при формировании запроса используется дневной интервал для всего запроса, т.е. выгрузка за каждый день и в поле Период подставляется Дата начала. Если "Месяц", то аналогично дню, только месячный интервал. Если поле "ПолеРегистратор" есть, то поле "Период" перезаписывается значением из поля "ПолеРегистратор".

#####  

##### **Вкладка "Настройки запросов" Здесь отображается табличная часть всех запросов, которые были добавлены в обработку Переключение между настройками запросов осуществляется через клик по наименованию "Имя таблицы".**

 

#### **Форма "Конструктор запросов"**

Стандартная форма конструктора запросов на языке 1С. Используется специалистами и программистами для создания своих схем компоновки данных на языке запросов 1С.

- **Вкладка "Таблицы и поля"**  Метаданные объектов доступные для использования в запросе в качестве полей. Здесь также можно задать параметры для виртуальных таблиц: Дата начала и окончания.
- Вкладка **"Группировка"** Какие поля группировать, а какие суммировать или усреднять.
- Вкладка **"Условия**" Задаются условия отбора данных запроса.
- Вкладка **"Дополнительно"** Здесь можно задать имя для пакета запроса или установить сколько записей отбирать.
- Вкладка **"Объединения/псевдонимы"** Задаем наименование полей запроса. Также можно выполнить и объединить несколько однотипных запросов в одном пакете.
- Вкладка **"Порядок"** Задаются параметры сортировки данных по полям и их порядок.
- Вкладка **"Пакет запросов"** Создаются дополнительные запросы внутри одного пакета запросов.